const secrets = require('config-dug').default;

const HEADER_AUTH = {
  CONTENT_TYPE: 'content-type',
  ACCEPT: 'application/json',
  CHARSET: 'utf-8',
  FORM_URLENCODED: 'application/x-www-form-urlencoded',
};

const IK_UD_CUSTOMER_SERVICE = {
  HOST: secrets.IK_UD_CUSTOMER_HOST_URL,
  PRIVATE_KEY: secrets.IK_PRIVATE_KEY,
  LICENSE_KEY: secrets.IK_UD_CUSTOMER_LICENSE_KEY,
  PUBLIC_KEY: secrets.IK_PUBLIC_KEY,
  AUTH_MODULE: secrets.IK_USERS_MGMT_AUTH_MODULE,
  COMMUNITY_NAME: secrets.IK_UD_CUSTOMER_COMMUNITY_NAME,
  COMMUNITY_ID: secrets.IK_UD_CUSTOMER_COMMUNITY_ID,
  TENANT_ID: secrets.IK_UD_CUSTOMER_TENANT_ID,
  TENANT_TAG: secrets.IK_UD_CUSTOMER_TENANT_TAG,
  SMS_TEMPLATE: secrets.IK_SMS_TEMPLATE,
  SMS_TRACE: secrets.IK_SMS_TRACE,
  SMS_FROM: secrets.IK_SMS_FROM,
};

const BAAS = {
  BASE_URL: secrets.BAAS_BASE_URL,
  IAM_APP_ID: secrets.BAAS_IAM_APP_ID,
  IAM_APP_SECRET: secrets.BAAS_IAM_APP_SECRET,
  PUBIC_APP_ID: secrets.BAAS_PUBLIC_ID,
  PUBLIC_APP_SECRET: secrets.BAAS_PUBLIC_SECRET,
};

const API_MANAGER = {
  BASE_URL: secrets.APIM_BASE_URL,
};

const BAAS_GRANT_TYPE = {
  PASSWORD: 'password',
  MFA: 'mfa',
  MFA_OTP: 'mfa_otp',
};

const NOTIF_TYPES = {
  SMS: 'SMS',
  EMAIL: 'EMAIL',
};

const REGULAR_EXPRESSION = {
  REMOVE_SPACE: /\s+/g,
  CHECK_NUMBER: /^\d+$/,
  VALID_NAME: /^[Ã±a-z\d\s]+$/i,
};

const JWT_CONFIG = {
  KMS_KEY: secrets.ASYMMETRIC_KMS_KEY,
  ALGO: 'RSASSA_PKCS1_V1_5_SHA_256',
  MESSAGE_TYPE: 'RAW',
  HEADER_ALG: 'RS256',
  HEADER_TYP: 'jWT',
  TOKEN_DURATION: 1800,
  TIME_FORMAT: 'seconds',
};

const USER_MIGRATION_CONFIG = {
  KMS_KEY: secrets.SYMMETRIC_KMS_KEY,
  DDB_DATASET_NAME: secrets.JWT_SESSION_DATASET_NAME,
};

const DYNAMO_CONFIG = {
  DB_NAME: secrets.DYNAMO_DB_NAME,
};

const PASSWORD_CONFIG = {
  NUMBER_OF_BYTES: secrets.PASSWORD_CONFIG_NUMBER_OF_BYTES,
  DIGEST: secrets.PASSWORD_CONFIG_DIGEST,
  KEY_LENGTH: secrets.PASSWORD_CONFIG_KEY_LENGTH,
  ITERATIONS: secrets.PASSWORD_CONFIG_ITERATIONS,
};

const COSTUMER_SERVICE_CONFIG = {
  BASE_URL: secrets.CUSTOMER_SERVICE_URL,
};

const IDA_CONFIG = {
  BASE_URL: process.env.IDA_BASE_URL,
};

const NOTIFICATION_SERVICE_CONFIG = {
  BASE_URL: process.env.NOTIFICATION_SERVICE_URL,
};

const FRAUD_MONITORING_SERVICE_CONFIG = {
  BASE_URL: process.env.FRAUD_MONITORING_SERVICE_URL,
  CUSTOM_HEADER_IP_NAME: 'x-original-forwarded-for',
};

const USER_REGISTRATION_CONFIG = {
  DDB_DATASET_NAME: 'ud_customer_otp',
  MFA_PURPOSE: 'USER_REGISTRATION',
  TEMPLATE: 'onboarding-otp-verification',
};

const WSO2_COUNTER_CONFIG = {
  DDB_DATASET_NAME: 'wso2_api_call_counter',
};

const FAILED_LOGIN_CONFIG = {
  DDB_DATASET_NAME: 'failed_login_counter',
  LOCKOUT_DURATION: secrets.FAILED_LOGIN_CONFIG_LOCKOUT_DURATION,
  MAX_ATTEMPTS: secrets.FAILED_LOGIN_CONFIG_MAX_ATTEMPTS,
};

const DEVICE_ENROLLMENT_CONFIG = {
  CUSTOM_HEADER_DEVICE_ID_NAME: 'x-ud-device-id',
  CUSTOM_HEADER_DEVICE_MAKE_MODEL_NAME: 'x-ud-device-make-model',
};

const MFA_OTP_CONFIG = {
  DDB_DATASET_NAME: 'ud_customer_otp',
  OTP_FORMAT: 'numeric',
  OTP_DURATION: 120,
  OTP_LENGTH: 6,
  OTP_COOLDOWN: 120,
  OTP_USER_COOLDOWN: 3600,
  OTP_MAX_ATTEMPTS: 3,
  OTP_TIME_FORMAT: 'seconds',
  OTP_COUNTER_DATASET_NAME: 'ud_customer_otp_attempts',
  OTP_COOLDOWN_DATASET_NAME: 'ud_customer_otp_cooldown',
  OTP_CHARS_NUMERIC: '1234567890',
  OTP_CHARS_ALPHANUMERIC: 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ',
};

const BLOCKED_LIST_USER = [
  '639455219479',
  '639610525197',
  '639922506814',
  '639679218979',
  '639089845103',
  '639778777877',
  '639175539962',
  '639222672679',
  '639560861876',
  '639085627497',
  '639474213050',
  '639484137187',
  '639294299076',
  '639474621855',
  '639955464336',
  '639154446673',
  '639694756985',
  '639982529884',
  '639929731832',
  '639922451944',
  '639668496092',
  '639312044444',
  '639264823378',
  '639560956022',
  '639694800043',
  '639277436232',
  '639365239880',
  '639773463247',
  '639996613078',
  '639773212798',
  '639391098541',
  '639214668804',
  '639704019394',
  '639270844365',
  '639655842959',
  '639564557844',
  '639754323826',
  '639218485731',
  '639297139751',
];

module.exports = {
  HEADER_AUTH,
  REGULAR_EXPRESSION,
  NOTIF_TYPES,
  IK_UD_CUSTOMER_SERVICE,
  BAAS_GRANT_TYPE,
  BAAS,
  API_MANAGER,
  JWT_CONFIG,
  USER_MIGRATION_CONFIG,
  DYNAMO_CONFIG,
  PASSWORD_CONFIG,
  COSTUMER_SERVICE_CONFIG,
  IDA_CONFIG,
  NOTIFICATION_SERVICE_CONFIG,
  USER_REGISTRATION_CONFIG,
  FRAUD_MONITORING_SERVICE_CONFIG,
  WSO2_COUNTER_CONFIG,
  FAILED_LOGIN_CONFIG,
  DEVICE_ENROLLMENT_CONFIG,
  MFA_OTP_CONFIG,
  BLOCKED_LIST_USER,
};
